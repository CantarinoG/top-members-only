<!DOCTYPE html>
<html lang="en">
  <head>
    <title> Secrecy </title>

    <link rel="icon" href="favicon/favicon.ico" />
    <link rel="apple-touch-icon" href="favicon/logo192.png" />

    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta
      name="description"
      content="An exclusive clubhouse where members can write anonymous posts and only authenticated members can see the post's author."
    />

  </head>

<body>

  <% if (user) {%>

    <header>
      <nav class="logo">
        <a href="#">SECRECY</a>
        <span><%= user.username %></span>
        <span>
          <form action="/logout" method="POST">
          <button type="submit">Log out</button>
          </form>
        </span>
      </nav>
      <nav>
              <a href="#">NEW MESSAGE</a>
              <a href="#">MEMBER STATUS</a>
      </nav>
  </header>

  <% } else { %>

    <header>
      <nav class="logo">
        <a href="#">SECRECY</a>
      </nav>
      <nav>
              <a href="#">SIGN UP</a>
              <a href="#">LOG IN</a>
      </nav>
  </header>

  <% } %>
    
    <ul>

      <% if (typeof messages != "undefined") { %>
        <% messages.forEach((message) => { %>
            <li>
                <span><%= message.title %></span>
                <span><%= message.content %></span>

                <% if(user && (user.status == "Admin" || user.status == "Member")) { %>
                  <span><%= message.user.fullname %></span>
                <% } else { %>
                  <span>Anonymous</span>
                <% } %>

                <% if (user) { %>
                  <span><%= message.timestamp %></span>
                <% } %>

            </li>
        <% }) %>
      <% } else { %>
          <li>No messages.</li>
      <% } %>

    </ul>

</body>
</html>
